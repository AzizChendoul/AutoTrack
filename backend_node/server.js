const express = require('express'); const fs = require('fs'); const path = require('path'); const app = express(); app.use(express.json()); const DB = path.join(__dirname,'data.json'); if(!fs.existsSync(DB)) fs.writeFileSync(DB, JSON.stringify({vehicle:{},maintenances:[]}, null, 2)); app.get('/api/data', (req,res)=> res.sendFile(DB)); app.post('/api/vehicle', (req,res)=> { const db = JSON.parse(fs.readFileSync(DB)); db.vehicle = req.body; fs.writeFileSync(DB, JSON.stringify(db,null,2)); res.json({ok:true}); }); app.post('/api/maintenances', (req,res)=> { const db = JSON.parse(fs.readFileSync(DB)); db.maintenances = db.maintenances || []; db.maintenances.push(req.body); fs.writeFileSync(DB, JSON.stringify(db,null,2)); res.json({ok:true}); }); app.listen(3000, ()=> console.log('AutoTrack backend listening on http://localhost:3000'));
